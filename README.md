# MCMC
马尔科夫链-蒙特卡洛算法，运用马尔科夫链性质去生成符合条件的一系列样本
给定一个状态转移矩阵Q，马尔科夫链可以收敛到平稳分布，即满足：
p(𝑖)𝑄(𝑖,𝑗)= 𝑝(𝑗)𝑄(𝑗,𝑖)
可以理解为从A状态跳转到B状态的概率，和从B状态跳转到A状态的概率相同

但实际应用中，我们并不清楚各个状态之间是如何转移的
因此我们现在应用的都是对MCMC进行改进的M-H算法（Metropolis-Hastings采样的简称，这个算法首先由Metropolis提出，被Hastings改进）
该算法引入接受率：

alpha(𝑖,𝑗)=min⁡{  (𝑝(𝑗)𝑄(𝑗,𝑖))/(𝑝(𝑖)𝑄(𝑖,𝑗)),1}

以满足马尔科夫链细致平稳条件：

p(𝑖)𝑄(𝑖,𝑗)alpha(𝑖,𝑗)= 𝑝(𝑗)𝑄(𝑗,𝑖)alpha(𝑗,𝑖)

马尔科夫链状态转移矩阵 𝑄 如果是对称的，即满足

𝑄(𝑖,𝑗)=𝑄(𝑗,𝑖)

这时我们的接受率可以进一步简化为：

alpha(𝑖,𝑗)=𝑚𝑖𝑛⁡{  (𝑝(𝑗))/(𝑝(𝑖)),1}

此时我们只要任意取一个状态转移矩阵即可，一般取一个正态分布，即下一步的样本在上一步附近以正态分布的概率转移

# 采样过程
采样算法过程如下：

1）输入我们任意选定的马尔科夫链状态转移矩阵 𝑄，平稳分布𝑝(𝑥) ，设定状态转移次数阈值𝑛1，需要的样本个数𝑛2。

2）从任意简单概率分布采样得到初始状态值𝑥0

3）𝑓𝑜𝑟 𝑡 = 0 𝑡𝑜  𝑛1 + 𝑛2 −1

    a) 从条件概率分布 𝑄(𝑥|𝑥𝑡) 中采样得到样本x∗

    b) 从均匀分布采样

    𝑢∼𝑢𝑛𝑖𝑓𝑜𝑟𝑚[0,1]

    c) 如 𝑢 < alpha(𝑖,𝑗)=min⁡{  (𝑝(𝑗)𝑄(𝑗,𝑖))/(𝑝(𝑖)𝑄(𝑖,𝑗)),1}，则接受转移，即

    𝑥_(𝑡+1)=x∗

    d) 否则不接受转移，即

    𝑥_(𝑡+1)=𝑥_𝑡
    重新从条件概率分布 𝑄(𝑥|𝑥𝑡) 中采样得到新样本x∗

样本集(𝑥_𝑛1,𝑥_(𝑛1+1),…,𝑥_(𝑛1+𝑛2−1))即为我们需要的平稳分布对应的样本集。


𝑝(𝑥) 一般用似然函数表示：

L(m)= k * exp(-||G(m)-d||/2*sigma^2 )

m为正演模型，d为待拟合数据，G(m)为正演过程，sigma为噪音水平

